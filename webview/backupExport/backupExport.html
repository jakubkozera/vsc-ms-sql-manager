<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Export Database Backup</title>
    <link rel="stylesheet" href="{{cssUri}}">
</head>
<body>
    <div class="container">
        <h1>Export Database Backup</h1>
        
        <div class="connection-info">
            <div class="connection-item">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M9.785 6l8.215 8.215l-2.054 2.054a5.81 5.81 0 1 1 -8.215 -8.215l2.054 -2.054z" />
                    <path d="M4 20l3.5 -3.5" />
                    <path d="M15 4l-3.5 3.5" />
                    <path d="M20 9l-3.5 3.5" />
                </svg>
                <span id="connectionName">Loading...</span>
            </div>
            <div class="connection-item">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M3 4m0 3a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v2a3 3 0 0 1 -3 3h-12a3 3 0 0 1 -3 -3z" />
                    <path d="M3 12m0 3a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v2a3 3 0 0 1 -3 3h-12a3 3 0 0 1 -3 -3z" />
                    <path d="M7 8l0 .01" />
                    <path d="M7 16l0 .01" />
                </svg>
                <span id="serverName">Loading...</span>
            </div>
            <div class="connection-item">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M12 6m-8 0a8 3 0 1 0 16 0a8 3 0 1 0 -16 0" />
                    <path d="M4 6v6a8 3 0 0 0 16 0v-6" />
                    <path d="M4 12v6a8 3 0 0 0 16 0v-6" />
                </svg>
                <span id="databaseName">Loading...</span>
            </div>
        </div>

        <form id="exportForm">
            <div class="form-group">
                <label for="fileFormat">File Format *</label>
                <select id="fileFormat" onchange="updateFormatOptions()">
                    <option value="bak">BAK - Database Backup (.bak)</option>
                    <option value="bacpac">BACPAC - Data-tier Application (.bacpac)</option>
                </select>
                <div class="help-text" id="formatHelp">Choose backup format: BAK for full backup or BACPAC for data export</div>
            </div>

            <div class="form-group">
                <label for="backupPath">Output File Path *</label>
                <div class="path-input-group">
                    <input type="text" id="backupPath" required placeholder="C:\\backup\\database_backup.bak">
                    <button type="button" id="selectPathBtn">Browse...</button>
                </div>
                <div class="help-text" id="pathHelp">Choose where to save the file (.bak or .bacpac extension)</div>
            </div>

            <div class="form-group">
                <label for="backupName">Backup Name</label>
                <input type="text" id="backupName" placeholder="Database Full Backup">
                <div class="help-text">Optional name for the backup set</div>
            </div>

            <div class="form-group">
                <label for="description">Description</label>
                <textarea id="description" placeholder="Full backup of the database"></textarea>
                <div class="help-text">Optional description of the backup</div>
            </div>

            <div class="form-group" id="advancedOptionsSection">
                <label>Advanced Options</label>
                <div class="checkbox-group">
                    <div class="checkbox-item">
                        <input type="checkbox" id="compression">
                        <label for="compression">Compression</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="checksum">
                        <label for="checksum">Verify Checksum</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="copyOnly">
                        <label for="copyOnly">Copy-only backup</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="continueAfterError">
                        <label for="continueAfterError">Continue after error</label>
                    </div>
                </div>
                <div class="help-text">
                    Compression reduces backup size. Checksum verifies backup integrity. 
                    Copy-only backup doesn't affect the regular backup sequence.
                </div>
            </div>

            <div class="progress" id="progressSection">
                <strong>Progress:</strong> <span id="progressMessage">Working...</span>
            </div>

            <div class="message" id="messageSection">
                <span id="messageText"></span>
            </div>

            <div class="buttons">
                <button type="button" class="secondary" id="cancelBtn">Cancel</button>
                <button type="submit" class="primary" id="exportBtn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M4 6c0 1.657 3.582 3 8 3s8 -1.343 8 -3s-3.582 -3 -8 -3s-8 1.343 -8 3" />
                        <path d="M4 6v6c0 1.657 3.582 3 8 3c1.118 0 2.183 -.086 3.15 -.241" />
                        <path d="M20 12v-6" />
                        <path d="M4 12v6c0 1.657 3.582 3 8 3c.157 0 .312 -.002 .466 -.005" />
                        <path d="M16 19h6" />
                        <path d="M19 16l3 3l-3 3" />
                    </svg>
                    Export Backup
                </button>
            </div>
        </form>

        <!-- Backdrop loader -->
        <div id="backdrop" class="backdrop">
            <div class="loader">
                <div class="spinner"></div>
                <div class="loader-message" id="loaderMessage">Exporting database backup...</div>
                <div class="loader-detail" id="loaderDetail">Please wait, this may take several minutes</div>
            </div>
        </div>
    </div>

    <script src="{{jsUri}}"></script>
</body>
</html>