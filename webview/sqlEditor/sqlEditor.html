<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="
        default-src 'none';
        script-src 'unsafe-inline' 'unsafe-eval' https://cdnjs.cloudflare.com https://d3js.org {{cspSource}};
        style-src 'unsafe-inline' https://cdnjs.cloudflare.com {{cspSource}};
        font-src https://cdnjs.cloudflare.com;
        worker-src blob:;
        img-src data: https: {{cspSource}};
    ">
    <title>SQL Editor</title>
    <link rel="stylesheet" href="{{styleUri}}">
</head>
<body>
    <div id="container">
        <div id="toolbar">
            <button class="toolbar-button" id="executeButton" title="Execute Query (F5 or Ctrl+Shift+E)">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M7 4v16l13 -8z" /></svg>
                Run
            </button>
            <label class="checkbox-label" title="Include Actual Execution Plan">
                <input type="checkbox" id="actualPlanCheckbox">
                <span>with execution plan</span>
            </label>
            <button class="toolbar-button secondary" id="cancelButton" disabled title="Cancel Query">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M5 5m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" /></svg>
                Cancel
            </button>
            <div class="toolbar-separator"></div>
            <label style="font-size: 13px;">Connection:</label>
            <div class="custom-dropdown" id="connection-dropdown">
                <button class="dropdown-trigger" id="connectionSelector">Not Connected</button>
                <div class="dropdown-menu" id="connection-menu"></div>
            </div>
            <label style="font-size: 13px; margin-left: 8px;" id="databaseLabel">Database:</label>
            <div class="custom-dropdown" id="database-dropdown" style="display: none;">
                <button class="dropdown-trigger" id="databaseSelector">Select database</button>
                <div class="dropdown-menu" id="database-menu"></div>
            </div>
            <button class="toolbar-button secondary" id="connectButton" title="Manage Connections">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M7 12l5 5l-1.5 1.5a3.536 3.536 0 1 1 -5 -5l1.5 -1.5z" /><path d="M17 12l-5 -5l1.5 -1.5a3.536 3.536 0 1 1 5 5l-1.5 1.5z" /><path d="M3 21l2.5 -2.5" /><path d="M18.5 5.5l2.5 -2.5" /><path d="M10 11l-2 2" /><path d="M13 14l-2 2" /></svg>
                Connect
            </button>
            <button class="toolbar-button secondary" id="estimatedPlanButton" title="Display Estimated Execution Plan" style="display: none;">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M4 16l6 -7l5 5l5 -6" />
                    <path d="M15 14m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
                    <path d="M10 9m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
                    <path d="M4 16m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
                    <path d="M20 8m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
                </svg>
                Estimated Plan
            </button>
            <div class="toolbar-separator"></div>
            <span id="statusLabel">Ready</span>
        </div>
        
        <div id="editorContainer">
            <div id="editor"></div>
        </div>

        <div class="resizer" id="resizer"></div>
        
        <div id="resultsContainer">
            <div class="results-tabs">
                <button class="results-tab active" data-tab="results">Results</button>
                <button class="results-tab" data-tab="messages">Messages</button>
                <button class="results-tab" data-tab="queryPlan" style="display: none;">Query Plan</button>
                <button class="results-tab" data-tab="planTree" style="display: none;">Plan Tree</button>
                <button class="results-tab" data-tab="topOperations" style="display: none;">Top Operations</button>
            </div>
            <div id="resultsContent" class="tab-content"></div>
            <div id="messagesContent" class="tab-content" style="display: none;"></div>
            <div id="queryPlanContent" class="tab-content" style="display: none;"></div>
            <div id="planTreeContent" class="tab-content" style="display: none;"></div>
            <div id="topOperationsContent" class="tab-content" style="display: none;"></div>
        </div>
    </div>

    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="{{monacoLoaderUri}}"></script>
    <script src="{{scriptUri}}"></script>
</body>
</html>